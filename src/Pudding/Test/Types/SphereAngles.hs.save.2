{-# OPTIONS_GHC -F -pgmF htfpp #-}

module Pudding.Test.Types.SphereAngles
(htf_thisModulesTests) where

import Data.Complex
import Test.Framework
import Pudding.Test.Aux (assertTrue)
import Pudding.Types.Internal.SphereAngles
import Pudding.Utilities.ComplexFunctions

instance Arbitrary SphereAngles where
  arbitrary = do
    theta <- arbitrary
    phi <- arbitrary
    return $ SphereAngles theta phi

north :: SphereAngles
north = SphereAngles 0 0

test_northSpinor =
  assertTrue $ (uCoordinate northSpinor) `complexEq` (1 :+ 0 ) &&
  (vCoordinate northSpinor) `complexEq` (0 :+ 0)
    where northSpinor = toSpinor north

prop_spinorBounds :: SphereAngles -> Bool
prop_spinorBounds =
